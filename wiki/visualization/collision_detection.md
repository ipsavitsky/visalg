# Collision detection

## Условие

Если кратко: хочется нарисовать симуляцию столкновения нескольких объектов.

Для этого предлагается реализовать алгоритм AABB(axis-aligned bounding box)

## Этапы выполнения задания

### 0) Написать свою библиотеку взаимодействия векторов на плоскости

> Подсказка: вектор в С++ не встроен, но встроена библиотека комплексных чисел. Из всех действий нам понадобятся: сложение, вычитание, домножение на число

### 1) Написать скелет иерархии классов

Предлагается реализовать следующую иерархию классов(предложения и исправления принимаются)

- Класс всей сцены
- Класс одного объекта, имеет в себе
  - Координаты текущего положения
  - Вектор движения объекта
  - [?]Вектор поворота объекта
  - *виртуальная* функция, которая проверяет коллизию с другим объектом
- Класс прямоугольника, который наследуется от класс объекта, имеет в себе
  - размер по X и по Y
- Класс круга, который тоже наследуется от класса объекта, имеет в себе
  - диаметр

### 2) Описать движение и отрисовку следующего кадра

Этот этап похож на соответствующий в любом Tier 1 - задании. Функция принимает сцену и отрисовывает все объекты в ней.

### 3) Описать столкновение двух прямоугольников

Тут начинается именно работа с AABB. Каждый прямоугольник легко описывается в другой прямоугольник, стороны которого параллельны осям $X$ и $Y$. Тогда, легко посчитать пересечение по каждой из сторон и, если пересечение по обеим, то можно зарегистрировать коллизию.

![Пересечение прямоугольников](https://learnopengl.com/img/in-practice/breakout/collisions_overlap.png)

### 4) Описать столкновение двух кругов

Самый просто этап. У каждого из кругов известен радиус и, если расстоняние между их центрами меньше или равно сумме их радиусов, то коллизия произошла

### 5) Описать столкновение прямоугольника и круга

Самый сложный вариант.

1. Посчитать вектор $\vec{D} = \vec{C} - \vec{B}$
2. Выполнить разложение внутри *прямоугольника*, что включает в себя

- Разложение вектора $\vec{D}$ по осям
- Разложению присваивается минимум между рассчитанным в предыдущем пункте значением и границами прямоугольника

3. Посчитать точку $\vec{P}$ как сумма разложений из прошлого этапа

![AABB](https://learnopengl.com/img/in-practice/breakout/collisions_aabb_circle.png)

4. Считаем точку $\vec{P}$ - самой приближенной точкой прямоугольника к кругу. Теперь если радиус круга больше расстояния от $\vec{P}$ до $\vec{C}$, то коллизия произошла, иначе - нет

### 6) Добавить физику

TODO: написать

## Источники

- [OpenGL](https://learnopengl.com/In-Practice/2D-Game/Collisions/Collision-detection)
